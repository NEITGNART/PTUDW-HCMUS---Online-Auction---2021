{{#section 'js'}}

{{!--
<script defer="defer" async="async"
    src="//cdn.tgdd.vn/mwgcart/mwgcore/js/bundle/detailTGDD.min.v202112141140.js"></script> --}}
{{!-- onclick="goToRSlide(2)" --}}
    <script>
        let days = 1;
        // Set the date we're counting down to
        var countDownDate = new Date(Date.now() + days * 24 * 3600 * 1000);
        // Update the count down every 1 second
        var x = setInterval(function () {

            // Get today's date and time
            var now = new Date().getTime();

            // Find the distance between now and the count down date
            var distance = countDownDate - now;

            // Time calculations for days, hours, minutes and seconds
            var days = Math.floor(distance / (1000 * 60 * 60 * 24));
            var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            var seconds = Math.floor((distance % (1000 * 60)) / 1000);

            // Display the result in the element with id="demo"

            var product = $(".product-one")

            for (let i = 0; i < product.length; ++i) {
                product[i].innerHTML = days + "d : " + hours + "h :" + minutes + "m :" + seconds + "s";
            }

            // If the count down is finished, write some text
            if (distance < 0) {
                clearInterval(x);
                $(".product-one").innerHTML = "EXPIRED";

            }
        }, 1000);

        // using jQuery to query id = sort and get value from select

        let valueSort = "";

        $(document).ready(function () {
            $("#sort").change(function () {
                var sort = $("#sort").val();
                sort = +sort;
                let url = window.location.href;

                if (sort === 1) {
                    // check that url has ?
                    if (url.includes("?")) {
                        if (url.includes("sort=expDate")) {
                            url = url.replace("sort=expDate", "sort=currentPrice");
                        } else {
                            url = url + "&sort=currentPrice";
                        }
                    } else {
                        url = url + "?sort=currentPrice";
                    }
                } else if (sort === 2) {
                    if (url.includes("?")) {
                        if (url.includes("sort=currentPrice")) {
                            url = url.replace("sort=currentPrice", "sort=expDate");
                        } else {
                            url = url + "&sort=expDate";
                        }
                    } else {
                        url = url + "?sort=expDate";
                    }
                } else {
                    // if remove sort=expDate or sort=currentPrice
                    if (url.includes("?")) {
                        if (url.includes("&sort=expDate")) {
                            url = url.replace("&sort=expDate", "");
                        } else if (url.includes("?sort=currentPrice")) {
                            url = url.replace("?sort=currentPrice", "");
                        } else if (url.includes("&sort=currentPrice")) {
                            url = url.replace("&sort=currentPrice", "");
                        } else {
                            url = url.replace("?sort=expDate", "");
                        }
                    } else {
                        window.location.href = url;
                    }
                }
                window.location.href = url;
            });
        });

        // using jQuery to query id = nuber-prroduct and get value selected from select

        $(document).ready(function () {
            $("#number-product").change(function () {
                var number = $("#number-product").val();
                number = +number;

                let url = window.location.href;

                if (number === 1) {
                    if (url.includes("?")) {
                        // check that url has limit= and then replace it with limit=12
                        if (url.includes("limit=")) {
                            url = url.replace(/limit=\d+/, "limit=12");
                        } else {
                            url = url + "&limit=12";
                        }
                    } else {
                        url = url + "?limit=12";
                    }
                } else if (number === 2) {

                    if (url.includes("?")) {
                        // check that url has limit= and then replace it with limit=12
                        if (url.includes("limit=")) {
                            url = url.replace(/limit=\d+/, "limit=9");
                        } else {
                            url = url + "&limit=9";
                        }
                    } else {
                        url = url + "?limit=9";
                    }


                } else if (number === 3) {
                    if (url.includes("?")) {
                        // check that url has limit= and then replace it with limit=12
                        if (url.includes("limit=")) {
                            url = url.replace(/limit=\d+/, "limit=6");
                        } else {
                            url = url + "&limit=6";
                        }
                    } else {
                        url = url + "?limit=6";
                    }
                }
                window.location.href = url;
            });


        });

        function handleCategory(category) {
            window.location.href = "?category=" + category;
        }


    </script>




{{/section}}


<style>
    .btn-heart {
        background-color: rgb(255, 255, 255);
        border-color: rgb(101, 101, 101);
        border-radius: 50%;
        border-style: solid;
        border-width: 1px;
        width: 30px;
        height: 30px;
        cursor: pointer;
        padding: 5px 4px 1px;
    }

    .icon-heart {
        max-height: 28px;
        display: inline-block;
    }
</style>

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">Trang chủ</a></li>
        <li class="breadcrumb-item"><a href="/product">Danh mục</a></li>
        <li class="breadcrumb-item active" aria-current="page">{{category}}</li>
    </ol>
</nav>


<div class="container-fluid d-lg-flex">


    <div class="row"></div>
    <!-- Sidebar category -->
    <div class="category-sidebar col-lg-3 col-12 col-sm-12 pr-sm-5  col-md-3 ml-3 mt-3 pr-lg-2">
        <div class="card dashboard-widget sticky-menu pl-sm-0 pl-0">
            <ul class="dashboard-menu">
                <li>

                    <div class="card-header bg-white mb-2 text-center">
                        <i class="fas fa-list-alt" aria-hidden="true"></i>
                        <p class="ml-2 d-inline-block ">Danh Mục Sản Phẩm</p>
                    </div>

                </li>

                <div class="card-body">
                    <li>
                        <a type="button" class="card-item" onclick="handleCategory(`Điện thoại`)">
                            <i class="fas fa-mobile-alt fa-2x mobile-2x"></i>
                            <span class="">Điện thoại di động</span>
                        </a>
                    </li>

                    <li>
                        <a type="button" onclick="handleCategory(`Laptop`)">
                            <i class="fas fa-laptop"></i>
                            Máy tính xách tay
                        </a>
                    </li>
                </div>


            </ul>
        </div>
        <!-- End sidebar category-->
    </div>


    <div class="container-fluid col-12 col-sm-12 col-lg-9 col-md-9 ml-lg-0 ml-3 pl-0">


        <div class="product-header m-17">
            <div class="product-header-item">
                <div class="item">Sort By :</div>


                <select id="sort" class="nice-select browser-default custom-select">
                    {{{checkSort sort}}}
                </select>
            </div>
            <div class="product-header-item">
                <div class="item">Show :</div>

                <select id="number-product" class="nice-select browser-default custom-select">
                    {{{checkLimit maxItems}}}
                </select>
            </div>

            <form class="d-flex">
                <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success" type="submit">Search</button>
            </form>

        </div>


        {{!-- Start Row --}}

        <div class="row">

            {{!-- Start Col --}}
            <div class="col">
                {{#each products}}

                {{!-- Start Item --}}
                    <div class="auction-item">
                        <div class="auction-item-thumb">
                            <a class="thumb-img" href="#">
                                <img src={{getThumbnail images}} alt="item">
                            </a>
                            <a class="star-icon thumb-icon" href="#">
                                <button class="btn btn-heart d-inline-block"><i class="icon-heart far fa-heart"
                                                                                aria-hidden="true"></i>
                                </button>
                            </a>
                        </div>
                        <div class="auction-item-content">
                            <div style="text-overflow: ellipsis; overflow: hidden; white-space: nowrap; width: 270px">
                                {{name}}</div>
                            <div class="bid-area d-flex justify-content-center">
                                <div class="bid-amount current-price d-flex">
                                    <div class="icon">
                                        <i class="fa fa-gavel fa-2x" aria-hidden="true"></i>
                                    </div>
                                    <div class="amount-content">
                                        <div class="current">
                                            Current Bid
                                        </div>
                                        <div class="amount">
                                            {{currentPrice}}
                                        </div>
                                    </div>
                                </div>
                                <div class="bid-amount buy-price d-flex">
                                    <div class="icon">
                                        <i class="fas fa-money-bill-wave fa-2x"></i>
                                    </div>
                                    <div class="amount-content">
                                        <div class="buy">
                                            Buy Now
                                        </div>
                                        <div class="amount">
                                            {{bestPrice}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="countdown-area d-flex">
                                <div class="countdown product-one">
                                </div>
                                <span class="total-bids">
                                30 bids
                            </span>
                            </div>
                            <div class="bid-now" type="button">
                                <a href="#">Bid now</a>
                            </div>
                        </div>
                    </div>
                {{!--End Item --}}

                {{/each}}

            </div>
            {{!-- End Col --}}


        </div>
        {{!-- End Row --}}

        {{!-- Pagination --}}


        <ul class="mt-3 pagination align-items-center justify-content-center">
            {{{displayPagination currentPage stringQuery maxPage}}}
        </ul>


        {{!-- End row --}}
    </div>
    <!-- end container -->


    {{!-- End product --}}
</div>

</div>